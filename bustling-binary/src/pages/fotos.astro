---
import Layout from "../layouts/Layout.astro";
import Nav from "../components/Nav.astro";

const RELEASE_MADRID = "2026-05-23T13:00:00";
---

<Layout>
    <Nav />

    <main class="wrap">
        <h1>Fotos del día</h1>

        <p id="locked" class="text">
            Este apartado estará disponible a partir del
            <strong>23 de mayo de 2026 · 13:00 h</strong>.
        </p>

        <section id="content" hidden>
            <p class="text">
                Aquí podrás subir tus fotos y ver el álbum compartido.
            </p>

            <div class="actions">
                <a
                    class="btn"
                    href="TU_LINK_SUBIDA"
                    target="_blank"
                    rel="noopener"
                >
                    Subir fotos
                </a>
                <a
                    class="btn"
                    href="TU_LINK_ALBUM"
                    target="_blank"
                    rel="noopener"
                >
                    Ver álbum
                </a>
            </div>
        </section>
    </main>
</Layout>

<script is:inline define:vars={{ RELEASE_MADRID }}>
    /** @returns {Date} */
    function madridNow() {
        const s = new Intl.DateTimeFormat("sv-SE", {
            timeZone: "Europe/Madrid",
            year: "numeric",
            month: "2-digit",
            day: "2-digit",
            hour: "2-digit",
            minute: "2-digit",
            second: "2-digit",
            hour12: false,
        }).format(new Date());
        return new Date(s.replace(" ", "T"));
    }

    /**
     * @param {string} isoLocal
     * @returns {Date}
     */
    function madridDate(isoLocal) {
        const s = new Intl.DateTimeFormat("sv-SE", {
            timeZone: "Europe/Madrid",
            year: "numeric",
            month: "2-digit",
            day: "2-digit",
            hour: "2-digit",
            minute: "2-digit",
            second: "2-digit",
            hour12: false,
        }).format(new Date(isoLocal));
        return new Date(s.replace(" ", "T"));
    }

    /** @type {HTMLParagraphElement|null} */
    const locked = document.getElementById("locked");
    /** @type {HTMLElement|null} */
    const content = document.getElementById("content");

    if (locked && content) {
        const host = location.hostname;
        const isLocal =
            host === "localhost" ||
            host === "127.0.0.1" ||
            host.startsWith("192.168.") ||
            host.startsWith("10.") ||
            host.endsWith(".local");

        const now = madridNow();
        const release = madridDate(RELEASE_MADRID);

        if (isLocal || now >= release) {
            locked.hidden = true;
            content.hidden = false;
        }
    }
</script>

<style>
    .wrap {
        max-width: 900px;
        margin: 0 auto;
        padding: 56px 16px;
        text-align: center;
        overflow-x: hidden;
    }

    h1 {
        margin: 0 0 14px;
        font-family: "Cormorant Garamond", serif;
        font-weight: 500;
        letter-spacing: 0.04em;
        color: #3f3a36;
    }

    .text {
        font-family: "Montserrat", sans-serif;
        color: rgba(63, 58, 54, 0.75);
        line-height: 1.7;
        margin: 0 auto 16px;
        max-width: 720px;
    }

    .actions {
        display: flex;
        gap: 12px;
        justify-content: center;
        flex-wrap: wrap;
        margin-top: 18px;
    }

    .btn {
        display: inline-block;
        padding: 12px 18px;
        border-radius: 999px;
        border: 1px solid rgba(63, 58, 54, 0.22);
        text-decoration: none;
        color: rgba(63, 58, 54, 0.88);
        font-family: "Montserrat", sans-serif;
        letter-spacing: 0.12em;
        text-transform: uppercase;
        font-size: 0.75rem;
        background: rgba(255, 255, 255, 0.55);
    }

    .btn:hover {
        background: rgba(255, 255, 255, 0.75);
    }
</style>
